<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ½ï¸ SNSì„¼í„° ì ì‹¬ ë°°ë¶„ í”„ë¡œê·¸ë¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #050510;
            color: #e0e6ed;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* í—¤ë” */
        .header {
            background: linear-gradient(135deg, #1e6deb 0%, #0052cc 100%);
            padding: 20px 0;
            box-shadow: 0 4px 20px rgba(30, 109, 235, 0.3);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-text {
            font-size: 22px;
            font-weight: bold;
            color: white;
            letter-spacing: 1px;
        }
        
        .mode-switch {
            display: flex;
            gap: 10px;
        }
        
        .mode-btn {
            padding: 10px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: transparent;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
        }
        
        .mode-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .mode-btn.active {
            background: rgba(255, 255, 255, 0.2);
            border-color: white;
        }
        
        /* ë¡œê·¸ì¸ ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: #0f1420;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
            max-width: 400px;
            width: 90%;
        }
        
        .modal-title {
            color: #1e6deb;
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .password-input {
            width: 100%;
            padding: 12px;
            background: #050510;
            border: 2px solid #1a2332;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        .password-input:focus {
            outline: none;
            border-color: #1e6deb;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
        }
        
        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .modal-btn.confirm {
            background: linear-gradient(135deg, #1e6deb 0%, #0052cc 100%);
            color: white;
        }
        
        .modal-btn.cancel {
            background: #1a2332;
            color: #e0e6ed;
        }
        
        .modal-btn:hover {
            transform: translateY(-2px);
        }
        
        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* ì‚¬ìš©ì ì •ë³´ ë°” */
        .user-info-bar {
            background: #0f1420;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .my-lunch-time {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .my-lunch-label {
            color: #9ca3af;
            font-size: 14px;
        }
        
        .my-lunch-value {
            background: linear-gradient(135deg, #1e6deb 0%, #0052cc 100%);
            padding: 8px 16px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
            font-size: 16px;
        }
        
        .name-setting {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .name-input {
            padding: 8px 12px;
            background: #050510;
            border: 2px solid #1a2332;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            width: 150px;
        }
        
        .save-name-btn {
            padding: 8px 16px;
            background: #1e6deb;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .save-name-btn:hover {
            background: #0052cc;
        }
        
        /* ê´€ë¦¬ì íŒ¨ë„ */
        .admin-panel {
            display: none;
            background: #0f1420;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .admin-panel.active {
            display: block;
        }
        
        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .control-section {
            background: #0a0a1a;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #1a2332;
        }
        
        .control-section h3 {
            color: #1e6deb;
            margin-bottom: 15px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            color: #9ca3af;
            margin-bottom: 5px;
            font-size: 13px;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            background: #050510;
            border: 2px solid #1a2332;
            border-radius: 8px;
            color: white;
            font-size: 14px;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #1e6deb;
        }
        
        .add-btn {
            padding: 8px 16px;
            background: #1e6deb;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .add-btn:hover {
            background: #0052cc;
        }
        
        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .tag {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .vacation-tag {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .pair-tag {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }
        
        .special-tag {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }
        
        /* ê²€ìƒ‰ ì œì•ˆ */
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #050510;
            border: 2px solid #1a2332;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            z-index: 100;
        }
        
        .search-suggestions.active {
            display: block;
        }
        
        .suggestion-item {
            padding: 10px;
            cursor: pointer;
            transition: background 0.2s;
            color: #e0e6ed;
            font-size: 14px;
        }
        
        .suggestion-item:hover {
            background: #0f1420;
        }
        
        .suggestion-item.selected {
            background: #1a2332;
        }
        
        /* ì„ íƒëœ ë©¤ë²„ í‘œì‹œ */
        .selected-members {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 10px 0;
            min-height: 40px;
            padding: 10px;
            background: #050510;
            border-radius: 8px;
            border: 1px dashed #1a2332;
        }
        
        .selected-member {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1a1f3a;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
            animation: slideIn 0.3s ease;
        }
        
        .selected-member button {
            background: none;
            border: none;
            color: #1a1f3a;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            line-height: 1;
            opacity: 0.7;
        }
        
        .selected-member button:hover {
            opacity: 1;
        }
        
        .tag button {
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            line-height: 1;
            opacity: 0.7;
        }
        
        .tag button:hover {
            opacity: 1;
        }
        
        .generate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(34, 197, 94, 0.4);
        }
        
        /* ìŠ¤ì¼€ì¤„ í‘œì‹œ ì˜ì—­ */
        .schedule-display {
            background: #0f1420;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .schedule-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #1a2332;
        }
        
        .schedule-title {
            font-size: 24px;
            color: #1e6deb;
            font-weight: bold;
        }
        
        .schedule-date {
            color: #9ca3af;
            font-size: 16px;
        }
        
        .stats-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            flex: 1;
            background: #0a0a1a;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #1a2332;
            text-align: center;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #1e6deb;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #9ca3af;
            font-size: 13px;
        }
        
        /* ì‹œê°„í‘œ */
        .time-slot {
            background: #0a0a1a;
            border: 1px solid #1a2332;
            border-radius: 10px;
            margin-bottom: 8px;
            transition: all 0.3s;
        }
        
        .time-slot:hover {
            background: #0f0f25;
            border-color: #1e6deb;
        }
        
        .time-slot.my-time {
            background: linear-gradient(135deg, rgba(30, 109, 235, 0.2) 0%, rgba(0, 82, 204, 0.2) 100%);
            border-color: #1e6deb;
            box-shadow: 0 0 20px rgba(30, 109, 235, 0.3);
        }
        
        .time-slot-content {
            display: flex;
            padding: 15px;
            align-items: center;
        }
        
        .time-label {
            width: 100px;
            font-weight: bold;
            color: #1e6deb;
            font-size: 18px;
        }
        
        .person-list {
            flex: 1;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .person-badge {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
        }
        
        /* íŒ€ë³„ ìƒ‰ìƒ (ì—‘ì…€ ê¸°ì¤€ - ë‹¤í¬ëª¨ë“œ ìµœì í™”) */
        .team-part1 { 
            background: rgba(226, 240, 217, 0.15); 
            color: #a7f3d0; 
            border: 1px solid rgba(226, 240, 217, 0.3); 
        }
        .team-part2 { 
            background: rgba(221, 235, 247, 0.15); 
            color: #93c5fd; 
            border: 1px solid rgba(221, 235, 247, 0.3); 
        }
        .team-part3 { 
            background: rgba(255, 242, 204, 0.15); 
            color: #fde047; 
            border: 1px solid rgba(255, 242, 204, 0.3); 
        }
        .team-part4 { 
            background: rgba(251, 229, 215, 0.15); 
            color: #fca5a5; 
            border: 1px solid rgba(251, 229, 215, 0.3); 
        }
        .team-part5 { 
            background: rgba(59, 130, 246, 0.2); 
            color: #3b82f6; 
            border: 1px solid rgba(59, 130, 246, 0.4); 
        }
        
        .leader-badge {
            background: linear-gradient(135deg, #ffd700 0%, #ffb300 100%) !important;
            color: #1a1f3a !important;
            font-weight: bold;
            border: none !important;
            position: relative;
        }
        
        .leader-badge::before {
            content: "â˜… ";
            color: #1a1f3a;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }
        
        .empty-icon {
            font-size: 80px;
            margin-bottom: 20px;
            opacity: 0.3;
        }
        
        .message {
            padding: 12px 20px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateY(-10px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .success-message {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }
        
        .warning-message {
            background: rgba(251, 146, 60, 0.2);
            color: #fb923c;
            border: 1px solid rgba(251, 146, 60, 0.3);
        }
        
        .error-message {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
    </style>
</head>
<body>
    <!-- í—¤ë” -->
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-text">ğŸ½ï¸ SNSì„¼í„° ì ì‹¬ ë°°ë¶„ í”„ë¡œê·¸ë¨</div>
            </div>
            <div class="mode-switch">
                <button class="mode-btn active" onclick="setMode('employee')">ìƒë‹´ì‚¬ ëª¨ë“œ</button>
                <button class="mode-btn" onclick="setMode('admin')">ê´€ë¦¬ì ëª¨ë“œ</button>
            </div>
        </div>
    </div>
    
    <!-- ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">ğŸ” ê´€ë¦¬ì ì¸ì¦</div>
            <input type="password" class="password-input" id="passwordInput" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            <div class="modal-buttons">
                <button class="modal-btn confirm" onclick="checkPassword()">í™•ì¸</button>
                <button class="modal-btn cancel" onclick="closePasswordModal()">ì·¨ì†Œ</button>
            </div>
            <div class="message error-message" id="passwordError"></div>
        </div>
    </div>
    
    <div class="container">
        <!-- ì‚¬ìš©ì ì •ë³´ ë°” -->
        <div class="user-info-bar">
            <div class="my-lunch-time">
                <span class="my-lunch-label">ë‚˜ì˜ ì˜¤ëŠ˜ ì ì‹¬ ì‹œê°„:</span>
                <span class="my-lunch-value" id="myLunchTime">ì„¤ì • í•„ìš”</span>
            </div>
            <div class="name-setting">
                <input type="text" class="name-input" id="userName" placeholder="ì´ë¦„ ì…ë ¥">
                <button class="save-name-btn" onclick="saveName()">ì €ì¥</button>
            </div>
        </div>
        
        <!-- ê´€ë¦¬ì íŒ¨ë„ -->
        <div id="adminPanel" class="admin-panel">
            <div class="control-grid">
                <!-- ë‚ ì§œ ì„¤ì • -->
                <div class="control-section">
                    <h3>ğŸ“… ë‚ ì§œ ì„¤ì •</h3>
                    <div class="form-group">
                        <input type="date" class="form-control" id="scheduleDate">
                    </div>
                </div>
                
                <!-- ì—°ì°¨ì ê´€ë¦¬ -->
                <div class="control-section">
                    <h3>ğŸ–ï¸ ì—°ì°¨ì ê´€ë¦¬</h3>
                    <div class="form-group">
                        <select class="form-control" id="vacationSelect">
                            <option value="">ì§ì› ì„ íƒ...</option>
                        </select>
                        <button class="add-btn" onclick="addVacation()">ì—°ì°¨ì ì¶”ê°€</button>
                    </div>
                    <div class="tag-list" id="vacationList"></div>
                </div>
                
                <!-- ì§ì§€ ì„¤ì • -->
                <div class="control-section">
                    <h3>ğŸ‘¥ ì§ì§€ ì„¤ì •</h3>
                    <div class="form-group">
                        <label class="form-label">íŒ€ ì„ íƒ</label>
                        <select class="form-control" id="pairTeamSelect" onchange="updatePairMembers()">
                            <option value="">íŒ€ ì„ íƒ...</option>
                            <option value="1íŒŒíŠ¸">1íŒŒíŠ¸</option>
                            <option value="2íŒŒíŠ¸">2íŒŒíŠ¸</option>
                            <option value="3íŒŒíŠ¸">3íŒŒíŠ¸</option>
                            <option value="4íŒŒíŠ¸">4íŒŒíŠ¸</option>
                            <option value="5íŒŒíŠ¸">5íŒŒíŠ¸ (ì˜ì •ë¶€)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì²« ë²ˆì§¸ ì§ì›</label>
                        <select class="form-control" id="pairMember1">
                            <option value="">ì„ íƒ...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ë‘ ë²ˆì§¸ ì§ì›</label>
                        <select class="form-control" id="pairMember2">
                            <option value="">ì„ íƒ...</option>
                        </select>
                    </div>
                    <button class="add-btn" onclick="addPair()">ì§ì§€ ì¶”ê°€</button>
                    <div class="tag-list" id="pairList"></div>
                </div>
                
                <!-- íŠ¹ë³„ ê´€ë¦¬ ëŒ€ìƒ -->
                <div class="control-section">
                    <h3>âš¡ íŠ¹ë³„ ê´€ë¦¬ ëŒ€ìƒ</h3>
                    <p style="color: #9ca3af; font-size: 12px; margin-bottom: 10px;">
                        ìƒë‹´ íŒŒì›Œê°€ ê°•í•´ ë™ì‹œì— ì ì‹¬ì„ ê°€ë©´ ì•ˆ ë˜ëŠ” ì§ì›ë“¤
                    </p>
                    <div class="form-group">
                        <div style="position: relative;">
                            <input type="text" 
                                   class="form-control" 
                                   id="specialSearchInput" 
                                   placeholder="ì´ë¦„ ì…ë ¥ í›„ Enter (ìµœì†Œ 2ëª…)"
                                   onkeyup="handleSpecialSearch(event)"
                                   autocomplete="off">
                            <div id="searchSuggestions" class="search-suggestions"></div>
                        </div>
                        <div class="selected-members" id="selectedMembers"></div>
                        <button class="add-btn" onclick="createSpecialGroup()" id="createGroupBtn" style="display: none;">
                            ê·¸ë£¹ ìƒì„± (0ëª… ì„ íƒë¨)
                        </button>
                    </div>
                    <div class="tag-list" id="specialList"></div>
                </div>
            </div>
            
            <button class="generate-btn" onclick="generateSchedule()">
                ğŸš€ ì ì‹¬ ì‹œê°„í‘œ ìƒì„±
            </button>
            
            <div class="message success-message" id="successMessage"></div>
            <div class="message warning-message" id="warningMessage"></div>
        </div>
        
        <!-- ìŠ¤ì¼€ì¤„ í‘œì‹œ ì˜ì—­ -->
        <div class="schedule-display">
            <div id="emptyState" class="empty-state">
                <div class="empty-icon">ğŸ“‹</div>
                <h2>ì ì‹¬ ì‹œê°„í‘œê°€ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤</h2>
                <p style="margin-top: 10px; color: #6b7280;">ê´€ë¦¬ìê°€ ì‹œê°„í‘œë¥¼ ìƒì„±í•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</p>
            </div>
            
            <div id="scheduleContent" style="display: none;">
                <div class="schedule-header">
                    <div class="schedule-title">ì ì‹¬ ì‹œê°„í‘œ</div>
                    <div class="schedule-date" id="scheduleDateDisplay"></div>
                </div>
                
                <div class="stats-row">
                    <div class="stat-card">
                        <div class="stat-value" id="totalCount">0</div>
                        <div class="stat-label">ì´ ì¸ì›</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="morningCount">0</div>
                        <div class="stat-label">ì˜¤ì „ ê·¼ë¬´</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="afternoonCount">0</div>
                        <div class="stat-label">ì˜¤í›„ ê·¼ë¬´</div>
                    </div>
                </div>
                
                <div id="scheduleTableContainer"></div>
            </div>
        </div>
    </div>
    
    <script>
        // ì§ì› ë°ì´í„° (ë¹…ë°ì´í„° ë¶„ì„ ê¸°ë°˜ ì—…ë°ì´íŠ¸)
        const employeeData = [
            // 1íŒŒíŠ¸
            { name: "ì´ì¢…ë¯¼", team: "1íŒŒíŠ¸", position: "íŒŒíŠ¸ì¥", shift: "ì˜¤ì „", startTime: "08:00" },
            { name: "ì •ì£¼ì—°", team: "1íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "09:00" },
            { name: "ì´í˜œì˜", team: "1íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            { name: "ê¹€êµ­í˜„", team: "1íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            { name: "ì •ë‹¤í˜œ", team: "1íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "09:00" },
            { name: "ì¡°ì‹œí˜„", team: "1íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "09:30" },
            { name: "ê¹€ì‹œìœ¤", team: "1íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            // 2íŒŒíŠ¸
            { name: "ìœ¤ë„ìš°ë¦¬", team: "2íŒŒíŠ¸", position: "íŒŒíŠ¸ì¥", shift: "ì˜¤ì „", startTime: "09:00" },
            { name: "ì‹ í˜œì„œ", team: "2íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "09:00" },
            { name: "ê¹€ìƒì•„", team: "2íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "09:30" },
            { name: "ë°•ì€ì§„", team: "2íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            { name: "ì˜¤ë¯¼í™˜", team: "2íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            { name: "ì„œì •êµ­", team: "2íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            // 3íŒŒíŠ¸
            { name: "ê¹€ì§„í›„", team: "3íŒŒíŠ¸", position: "íŒŒíŠ¸ì¥", shift: "ì˜¤í›„", startTime: "13:00" },
            { name: "ê¹€ì‹œì§„", team: "3íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "10:00" },
            { name: "ê¶Œì¬í˜„", team: "3íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "10:00" },
            { name: "ê¹€ì§€ì›", team: "3íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "10:00" },
            { name: "ìµœí˜¸ìµ", team: "3íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            { name: "ê¹€ì§„í˜‘", team: "3íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            { name: "ë°•í•´ì˜", team: "3íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "08:00" },
            { name: "ê¹€ì¢…í˜„", team: "3íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            { name: "ê³µí˜„ì¤€", team: "3íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "09:00" },
            // 4íŒŒíŠ¸
            { name: "ì´ë¯¼ì£¼", team: "4íŒŒíŠ¸", position: "íŒŒíŠ¸ì¥", shift: "ì˜¤ì „", startTime: "09:00" },
            { name: "ì „ì§€ìœ¤", team: "4íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "08:00" },
            { name: "ì „ë¯¸ë€", team: "4íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            { name: "ê¹€ì±„ì˜", team: "4íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "09:00" },
            { name: "ê¹€ì˜ì§„", team: "4íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            { name: "ê°•í—Œì¤€", team: "4íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤í›„", startTime: "13:00" },
            // 5íŒŒíŠ¸ (ì˜ì •ë¶€)
            { name: "ì°¨ì •í™˜", team: "5íŒŒíŠ¸", position: "íŒŒíŠ¸ì¥", shift: "ì˜¤ì „", startTime: "10:00" },
            { name: "ìµœìˆ˜ëŠ¥", team: "5íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "10:00" },
            { name: "êµ¬ë³¸ì˜", team: "5íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "10:00" },
            { name: "ì„œë¯¼êµ­", team: "5íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "10:00" },
            { name: "ì˜¤ë¯¼ê²½", team: "5íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "10:00" },
            { name: "ê¹€ë²”ì£¼", team: "5íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "10:00" },
            { name: "ë™ìˆ˜ì§„", team: "5íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "09:30" },
            { name: "ì„±ì¼í›ˆ", team: "5íŒŒíŠ¸", position: "íŒŒíŠ¸ì›", shift: "ì˜¤ì „", startTime: "10:00" }
        ];
        
        // ì „ì—­ ë³€ìˆ˜
        const leaders = ["ì´ì¢…ë¯¼", "ìœ¤ë„ìš°ë¦¬", "ê¹€ì§„í›„", "ì´ë¯¼ì£¼", "ì°¨ì •í™˜"];
        const lunchSlots = [
            "11:30", "12:00", "12:30", "13:00", "13:30",
            "14:00", "14:30", "15:00", "15:30", "16:00",
            "16:30", "17:00", "17:30", "18:00", "18:30",
            "19:00", "19:30"
        ];
        const leaderSlots = ["12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00"];
        const memberSlots = ["11:30", "12:30", "13:30", "14:30", "15:30", "16:30", "17:30", "18:30", "19:30"];
        
        let currentMode = 'employee';
        let vacationList = [];
        let pairList = [];
        let specialGroups = [];
        let selectedSpecialMembers = [];
        let currentSchedule = null;
        
        // ì´ˆê¸°í™”
        window.onload = function() {
            // ì˜¤ëŠ˜ ë‚ ì§œ ì„¤ì •
            const today = new Date();
            document.getElementById('scheduleDate').value = today.toISOString().split('T')[0];
            
            // ì§ì› ëª©ë¡ ì±„ìš°ê¸°
            const vacationSelect = document.getElementById('vacationSelect');
            employeeData.forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.name;
                option.textContent = `${emp.name} (${emp.team})`;
                vacationSelect.appendChild(option);
            });
            
            // íŠ¹ë³„ ê´€ë¦¬ ëŒ€ìƒ ì´ˆê¸°í™”
            updateSelectedMembersDisplay();
            
            // ì €ì¥ëœ ì´ë¦„ ë¶ˆëŸ¬ì˜¤ê¸°
            loadUserName();
            
            // ì €ì¥ëœ ìŠ¤ì¼€ì¤„ ë¶ˆëŸ¬ì˜¤ê¸°
            loadScheduleFromStorage();
        };
        
        // ëª¨ë“œ ì „í™˜
        function setMode(mode) {
            if (mode === 'admin') {
                document.getElementById('passwordModal').classList.add('active');
            } else {
                currentMode = 'employee';
                document.getElementById('adminPanel').classList.remove('active');
                document.querySelectorAll('.mode-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector('.mode-btn').classList.add('active');
            }
        }
        
        // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
        function checkPassword() {
            const password = document.getElementById('passwordInput').value;
            if (password === '3504') {
                currentMode = 'admin';
                document.getElementById('adminPanel').classList.add('active');
                document.querySelectorAll('.mode-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll('.mode-btn')[1].classList.add('active');
                closePasswordModal();
            } else {
                const errorMsg = document.getElementById('passwordError');
                errorMsg.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                errorMsg.style.display = 'block';
                setTimeout(() => {
                    errorMsg.style.display = 'none';
                }, 3000);
            }
        }
        
        // ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ ë‹«ê¸°
        function closePasswordModal() {
            document.getElementById('passwordModal').classList.remove('active');
            document.getElementById('passwordInput').value = '';
        }
        
        // ì´ë¦„ ì €ì¥
        function saveName() {
            const name = document.getElementById('userName').value.trim();
            if (name) {
                localStorage.setItem('userName', name);
                updateMyLunchTime();
                showSuccess(`${name}ë‹˜ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }
        
        // ì €ì¥ëœ ì´ë¦„ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadUserName() {
            const savedName = localStorage.getItem('userName');
            if (savedName) {
                document.getElementById('userName').value = savedName;
                updateMyLunchTime();
            }
        }
        
        // ë‚˜ì˜ ì ì‹¬ ì‹œê°„ ì—…ë°ì´íŠ¸
        function updateMyLunchTime() {
            const userName = localStorage.getItem('userName');
            const myLunchElement = document.getElementById('myLunchTime');
            
            if (!userName || !currentSchedule) {
                myLunchElement.textContent = 'ì„¤ì • í•„ìš”';
                return;
            }
            
            let myTime = null;
            for (const [time, people] of Object.entries(currentSchedule)) {
                if (people.some(p => p.name === userName)) {
                    myTime = time;
                    break;
                }
            }
            
            myLunchElement.textContent = myTime || 'ë¯¸ë°°ì •';
            highlightMyTime();
        }
        
        // ë‚´ ì‹œê°„ í•˜ì´ë¼ì´íŠ¸
        function highlightMyTime() {
            const userName = localStorage.getItem('userName');
            if (!userName || !currentSchedule) return;
            
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('my-time');
            });
            
            document.querySelectorAll('.time-slot').forEach(slot => {
                const badges = slot.querySelectorAll('.person-badge');
                badges.forEach(badge => {
                    if (badge.textContent.includes(userName)) {
                        slot.classList.add('my-time');
                    }
                });
            });
        }
        
        // ì—°ì°¨ì ì¶”ê°€
        function addVacation() {
            const select = document.getElementById('vacationSelect');
            const name = select.value;
            
            if (name && !vacationList.includes(name)) {
                vacationList.push(name);
                updateVacationDisplay();
                select.value = '';
                showSuccess(`${name}ë‹˜ì´ ì—°ì°¨ìë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }
        
        // ì—°ì°¨ì ì œê±°
        function removeVacation(name) {
            vacationList = vacationList.filter(v => v !== name);
            updateVacationDisplay();
        }
        
        // ì—°ì°¨ì ëª©ë¡ í‘œì‹œ
        function updateVacationDisplay() {
            const container = document.getElementById('vacationList');
            container.innerHTML = '';
            
            vacationList.forEach(name => {
                const tag = document.createElement('div');
                tag.className = 'tag vacation-tag';
                tag.innerHTML = `
                    ${name}
                    <button onclick="removeVacation('${name}')">Ã—</button>
                `;
                container.appendChild(tag);
            });
        }
        
        // íŒ€ì› ëª©ë¡ ì—…ë°ì´íŠ¸
        function updatePairMembers() {
            const team = document.getElementById('pairTeamSelect').value;
            const member1Select = document.getElementById('pairMember1');
            const member2Select = document.getElementById('pairMember2');
            
            member1Select.innerHTML = '<option value="">ì„ íƒ...</option>';
            member2Select.innerHTML = '<option value="">ì„ íƒ...</option>';
            
            if (team) {
                const teamMembers = employeeData.filter(emp => emp.team === team);
                teamMembers.forEach(emp => {
                    member1Select.innerHTML += `<option value="${emp.name}">${emp.name}</option>`;
                    member2Select.innerHTML += `<option value="${emp.name}">${emp.name}</option>`;
                });
            }
        }
        
        // ì§ì§€ ì¶”ê°€
        function addPair() {
            const member1 = document.getElementById('pairMember1').value;
            const member2 = document.getElementById('pairMember2').value;
            
            if (member1 && member2 && member1 !== member2) {
                const pairKey = [member1, member2].sort().join('-');
                const exists = pairList.some(pair => {
                    const key = [pair.member1, pair.member2].sort().join('-');
                    return key === pairKey;
                });
                
                if (!exists) {
                    pairList.push({ member1, member2 });
                    updatePairDisplay();
                    document.getElementById('pairMember1').value = '';
                    document.getElementById('pairMember2').value = '';
                    showSuccess(`${member1}ë‹˜ê³¼ ${member2}ë‹˜ì´ ì§ì§€ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                } else {
                    showWarning('ì´ë¯¸ ì„¤ì •ëœ ì§ì§€ì…ë‹ˆë‹¤.');
                }
            } else if (member1 === member2) {
                showWarning('ê°™ì€ ì‚¬ëŒì„ ì§ì§€ë¡œ ì„¤ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }
        
        // ì§ì§€ ì œê±°
        function removePair(index) {
            pairList.splice(index, 1);
            updatePairDisplay();
        }
        
        // ì§ì§€ ëª©ë¡ í‘œì‹œ
        function updatePairDisplay() {
            const container = document.getElementById('pairList');
            container.innerHTML = '';
            
            pairList.forEach((pair, index) => {
                const tag = document.createElement('div');
                tag.className = 'tag pair-tag';
                tag.innerHTML = `
                    ${pair.member1} â†” ${pair.member2}
                    <button onclick="removePair(${index})">Ã—</button>
                `;
                container.appendChild(tag);
            });
        }
        
        // íŠ¹ë³„ ê´€ë¦¬ ëŒ€ìƒ ê²€ìƒ‰ ì²˜ë¦¬
        function handleSpecialSearch(event) {
            const input = document.getElementById('specialSearchInput');
            const searchValue = input.value.trim().toLowerCase();
            const suggestionsDiv = document.getElementById('searchSuggestions');
            
            if (event.key === 'Enter' && searchValue) {
                const firstMatch = employeeData.find(emp => 
                    emp.name.toLowerCase().includes(searchValue) &&
                    !selectedSpecialMembers.includes(emp.name)
                );
                
                if (firstMatch) {
                    addSpecialMember(firstMatch.name);
                    input.value = '';
                    suggestionsDiv.classList.remove('active');
                }
                return;
            }
            
            if (searchValue) {
                const matches = employeeData.filter(emp => 
                    emp.name.toLowerCase().includes(searchValue) &&
                    !selectedSpecialMembers.includes(emp.name)
                );
                
                if (matches.length > 0) {
                    suggestionsDiv.innerHTML = matches.map(emp => 
                        `<div class="suggestion-item" onclick="addSpecialMember('${emp.name}')">
                            ${emp.name} (${emp.team})
                        </div>`
                    ).join('');
                    suggestionsDiv.classList.add('active');
                } else {
                    suggestionsDiv.classList.remove('active');
                }
            } else {
                suggestionsDiv.classList.remove('active');
            }
        }
        
        // íŠ¹ë³„ ê´€ë¦¬ ëŒ€ìƒ ë©¤ë²„ ì¶”ê°€
        function addSpecialMember(name) {
            if (!selectedSpecialMembers.includes(name)) {
                selectedSpecialMembers.push(name);
                updateSelectedMembersDisplay();
                document.getElementById('specialSearchInput').value = '';
                document.getElementById('searchSuggestions').classList.remove('active');
            }
        }
        
        // íŠ¹ë³„ ê´€ë¦¬ ëŒ€ìƒ ë©¤ë²„ ì œê±°
        function removeSpecialMember(name) {
            selectedSpecialMembers = selectedSpecialMembers.filter(m => m !== name);
            updateSelectedMembersDisplay();
        }
        
        // ì„ íƒëœ ë©¤ë²„ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateSelectedMembersDisplay() {
            const container = document.getElementById('selectedMembers');
            const createBtn = document.getElementById('createGroupBtn');
            
            if (selectedSpecialMembers.length > 0) {
                container.innerHTML = selectedSpecialMembers.map(name => 
                    `<div class="selected-member">
                        ${name}
                        <button onclick="removeSpecialMember('${name}')">Ã—</button>
                    </div>`
                ).join('');
                
                if (selectedSpecialMembers.length >= 2) {
                    createBtn.style.display = 'block';
                    createBtn.textContent = `ê·¸ë£¹ ìƒì„± (${selectedSpecialMembers.length}ëª… ì„ íƒë¨)`;
                } else {
                    createBtn.style.display = 'block';
                    createBtn.textContent = `ìµœì†Œ 2ëª… ì´ìƒ ì„ íƒí•˜ì„¸ìš” (í˜„ì¬ ${selectedSpecialMembers.length}ëª…)`;
                    createBtn.disabled = true;
                }
            } else {
                container.innerHTML = '<span style="color: #6b7280; font-size: 13px;">ì„ íƒëœ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤</span>';
                createBtn.style.display = 'none';
            }
            
            createBtn.disabled = selectedSpecialMembers.length < 2;
        }
        
        // íŠ¹ë³„ ê´€ë¦¬ ê·¸ë£¹ ìƒì„±
        function createSpecialGroup() {
            if (selectedSpecialMembers.length < 2) {
                showWarning('íŠ¹ë³„ ê´€ë¦¬ ëŒ€ìƒì€ ìµœì†Œ 2ëª… ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const isDuplicate = specialGroups.some(group => {
                const sortedNew = [...selectedSpecialMembers].sort().join(',');
                const sortedExisting = [...group].sort().join(',');
                return sortedNew === sortedExisting;
            });
            
            if (!isDuplicate) {
                specialGroups.push([...selectedSpecialMembers]);
                updateSpecialDisplay();
                selectedSpecialMembers = [];
                updateSelectedMembersDisplay();
                showSuccess(`íŠ¹ë³„ ê´€ë¦¬ ê·¸ë£¹ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!`);
            } else {
                showWarning('ì´ë¯¸ ë“±ë¡ëœ ê·¸ë£¹ì…ë‹ˆë‹¤.');
            }
        }
        
        // íŠ¹ë³„ ê´€ë¦¬ ëŒ€ìƒ ê·¸ë£¹ ì œê±°
        function removeSpecialGroup(index) {
            specialGroups.splice(index, 1);
            updateSpecialDisplay();
        }
        
        // íŠ¹ë³„ ê´€ë¦¬ ëŒ€ìƒ ëª©ë¡ í‘œì‹œ
        function updateSpecialDisplay() {
            const container = document.getElementById('specialList');
            container.innerHTML = '';
            
            specialGroups.forEach((group, index) => {
                const tag = document.createElement('div');
                tag.className = 'tag special-tag';
                const displayText = group.length > 3 
                    ? `${group.slice(0, 3).join(', ')}... (${group.length}ëª…)`
                    : group.join(', ');
                tag.innerHTML = `
                    âš¡ ${displayText}
                    <button onclick="removeSpecialGroup(${index})">Ã—</button>
                `;
                tag.title = group.join(', ');
                container.appendChild(tag);
            });
        }
        
        // ì ì‹¬ ì‹œê°„í‘œ ìƒì„± (ë¹…ë°ì´í„° ê¸°ë°˜ ìµœì í™”)
        function generateSchedule() {
            const availableEmployees = employeeData.filter(emp => !vacationList.includes(emp.name));
            
            if (availableEmployees.length === 0) {
                showWarning('ë°°ì • ê°€ëŠ¥í•œ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const schedule = {};
            lunchSlots.forEach(slot => {
                schedule[slot] = [];
            });
            
            // ì˜¤ì „/ì˜¤í›„ ê·¼ë¬´ì ë¶„ë¦¬
            const morningWorkers = availableEmployees.filter(emp => emp.shift === 'ì˜¤ì „');
            const afternoonWorkers = availableEmployees.filter(emp => emp.shift === 'ì˜¤í›„');
            
            // íŒŒíŠ¸ì¥ê³¼ íŒŒíŠ¸ì› ë¶„ë¦¬
            const morningLeaders = morningWorkers.filter(emp => leaders.includes(emp.name));
            const morningMembers = morningWorkers.filter(emp => !leaders.includes(emp.name));
            const afternoonLeaders = afternoonWorkers.filter(emp => leaders.includes(emp.name));
            const afternoonMembers = afternoonWorkers.filter(emp => !leaders.includes(emp.name));
            
            // ë¹…ë°ì´í„° ê¸°ë°˜ ì„ í˜¸ ì‹œê°„ëŒ€ íŒ¨í„´
            const preferredTimes = {
                "11:30": ["ì •ë‹¤í˜œ", "ì„±ì¼í›ˆ", "ê¹€ë²”ì£¼", "ì¡°ì‹œí˜„"],
                "12:30": ["ê¹€ì±„ì˜", "ë°•í•´ì˜", "ì˜¤ë¯¼ê²½", "ê¶Œì¬í˜„", "ê³µí˜„ì¤€"],
                "13:30": ["êµ¬ë³¸ì˜", "ì •ì£¼ì—°", "ì „ì§€ìœ¤", "ì‹ í˜œì„œ", "ê¹€ìƒì•„"],
                "14:30": ["ê¹€ì‹œì§„", "ì„œë¯¼êµ­", "ìµœìˆ˜ëŠ¥"],
                "15:30": ["ê¹€ì§€ì›", "ë™ìˆ˜ì§„", "ê¹€êµ­í˜„", "ì´í˜œì˜"],
                "16:30": ["ì „ë¯¸ë€", "ê¹€ì‹œìœ¤", "ìµœí˜¸ìµ", "ê¹€ì¢…í˜„"],
                "17:30": ["ì„œì •êµ­", "ê¹€ì˜ì§„", "ê°•í—Œì¤€"],
                "18:30": ["ê¹€ì§„í˜‘", "ì˜¤ë¯¼í™˜", "ë°•ì€ì§„"]
            };
            
            // ìì£¼ í•¨ê»˜ ì ì‹¬ì„ ë¨¹ëŠ” ê·¸ë£¹
            const frequentGroups = [
                ["ì •ë‹¤í˜œ", "ì„±ì¼í›ˆ", "ê¹€ë²”ì£¼"],
                ["ì„œë¯¼êµ­", "ìµœìˆ˜ëŠ¥"],
                ["ê¹€ì§€ì›", "ë™ìˆ˜ì§„"],
                ["ê¹€ì˜ì§„", "ê¹€ì§„í˜‘"],
                ["ê¹€êµ­í˜„", "ê¹€ì‹œìœ¤"],
                ["ì˜¤ë¯¼ê²½", "êµ¬ë³¸ì˜", "ê³µí˜„ì¤€"]
            ];
            
            // 1. íŒŒíŠ¸ì¥ ë°°ì • (ë¹…ë°ì´í„° ê¸°ë°˜)
            const leaderPreferences = {
                "ì´ì¢…ë¯¼": ["12:00", "13:00"],
                "ì°¨ì •í™˜": ["12:00", "13:00", "15:00", "16:00"],
                "ì´ë¯¼ì£¼": ["14:00", "16:00"],
                "ìœ¤ë„ìš°ë¦¬": ["15:00", "16:00", "17:30"],
                "ê¹€ì§„í›„": ["17:00", "18:30"]
            };
            
            [...morningLeaders, ...afternoonLeaders].forEach(leader => {
                const preferences = leaderPreferences[leader.name] || 
                    (leader.shift === "ì˜¤ì „" ? ["13:00", "14:00", "15:00", "16:00"] : ["17:00", "18:00"]);
                
                let bestSlot = null;
                let minCount = Infinity;
                
                for (const slot of preferences) {
                    if (schedule[slot].length < minCount) {
                        minCount = schedule[slot].length;
                        bestSlot = slot;
                    }
                }
                
                if (bestSlot) {
                    schedule[bestSlot].push(leader);
                }
            });
            
            // 2. íŒŒíŠ¸ì› ë°°ì • (ë¹…ë°ì´í„° ê¸°ë°˜ íŒ¨í„´ ì ìš©)
            const assignedMembers = new Set();
            
            // ì„ í˜¸ ì‹œê°„ëŒ€ê°€ ìˆëŠ” ì§ì›ë“¤ ìš°ì„  ë°°ì •
            Object.entries(preferredTimes).forEach(([time, names]) => {
                const [hour, minute] = time.split(':').map(Number);
                
                names.forEach(name => {
                    const member = [...morningMembers, ...afternoonMembers].find(m => m.name === name);
                    if (member && !assignedMembers.has(name) && !vacationList.includes(name)) {
                        const canAssign = (member.shift === "ì˜¤ì „" && (hour < 16 || (hour === 16 && minute === 0))) ||
                                        (member.shift === "ì˜¤í›„" && hour >= 15);
                        
                        if (canAssign && schedule[time].length < 5) {
                            schedule[time].push(member);
                            assignedMembers.add(name);
                        }
                    }
                });
            });
            
            // ë‚˜ë¨¸ì§€ ì§ì›ë“¤ ë°°ì •
            const remainingMembers = [...morningMembers, ...afternoonMembers].filter(
                m => !assignedMembers.has(m.name)
            );
            
            remainingMembers.forEach(member => {
                const availableSlots = member.shift === "ì˜¤ì „" 
                    ? memberSlots.filter(slot => {
                        const [hour, minute] = slot.split(':').map(Number);
                        return hour < 16 || (hour === 16 && minute === 0);
                    })
                    : memberSlots.filter(slot => {
                        const [hour] = slot.split(':').map(Number);
                        return hour >= 15;
                    });
                
                let bestSlot = null;
                let bestScore = -Infinity;
                
                for (const slot of availableSlots) {
                    let score = 0;
                    
                    // ì¸ì›ì´ ì ì€ ì‹œê°„ëŒ€ ì„ í˜¸
                    score -= schedule[slot].length * 10;
                    
                    // ìì£¼ í•¨ê»˜ ë¨¹ëŠ” ê·¸ë£¹ ì²´í¬
                    const friendsInSlot = schedule[slot].filter(emp => {
                        return frequentGroups.some(group => 
                            group.includes(member.name) && group.includes(emp.name)
                        );
                    }).length;
                    score += friendsInSlot * 5;
                    
                    // ê°™ì€ íŒ€ ë„ˆë¬´ ë§ìœ¼ë©´ ê°ì 
                    const sameTeamCount = schedule[slot].filter(emp => 
                        emp.team === member.team && !leaders.includes(emp.name)
                    ).length;
                    if (sameTeamCount >= 2) score -= 20;
                    
                    // ì§ì§€ ì²´í¬
                    const hasPair = schedule[slot].some(emp => {
                        return pairList.some(pair => 
                            (pair.member1 === member.name && pair.member2 === emp.name) ||
                            (pair.member2 === member.name && pair.member1 === emp.name)
                        );
                    });
                    if (hasPair) score += 30;
                    
                    // íŠ¹ë³„ ê´€ë¦¬ ëŒ€ìƒ ì²´í¬
                    const hasSpecialConflict = schedule[slot].some(emp => {
                        return specialGroups.some(group => 
                            group.includes(member.name) && group.includes(emp.name)
                        );
                    });
                    if (hasSpecialConflict) score -= 100;
                    
                    // ì‹œê°„ëŒ€ë³„ ìµœëŒ€ ì¸ì› ì œí•œ
                    if (schedule[slot].length >= 5) score -= 1000;
                    
                    if (score > bestScore) {
                        bestScore = score;
                        bestSlot = slot;
                    }
                }
                
                if (bestSlot && schedule[bestSlot].length < 6) {
                    schedule[bestSlot].push(member);
                }
            });
            
            // ë¹ˆ ì‹œê°„ëŒ€ ì œê±°
            Object.keys(schedule).forEach(slot => {
                if (schedule[slot].length === 0) {
                    delete schedule[slot];
                }
            });
            
            currentSchedule = schedule;
            saveScheduleToStorage();
            displaySchedule(schedule);
            showSuccess('ì ì‹¬ ì‹œê°„í‘œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
        
        // ìŠ¤ì¼€ì¤„ ì €ì¥
        function saveScheduleToStorage() {
            const scheduleData = {
                date: document.getElementById('scheduleDate').value,
                schedule: currentSchedule,
                timestamp: new Date().getTime()
            };
            localStorage.setItem('lunchSchedule', JSON.stringify(scheduleData));
        }
        
        // ìŠ¤ì¼€ì¤„ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadScheduleFromStorage() {
            const saved = localStorage.getItem('lunchSchedule');
            if (saved) {
                const data = JSON.parse(saved);
                const today = new Date().toISOString().split('T')[0];
                if (data.date === today) {
                    currentSchedule = data.schedule;
                    displaySchedule(currentSchedule);
                }
            }
        }
        
        // ë°°ì—´ ì„ê¸°
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // íŒ€ë³„ í´ë˜ìŠ¤
        function getTeamClass(team) {
            const teamMap = {
                '1íŒŒíŠ¸': 'team-part1',
                '2íŒŒíŠ¸': 'team-part2',
                '3íŒŒíŠ¸': 'team-part3',
                '4íŒŒíŠ¸': 'team-part4',
                '5íŒŒíŠ¸': 'team-part5'
            };
            return teamMap[team] || '';
        }
        
        // ìŠ¤ì¼€ì¤„ í‘œì‹œ
        function displaySchedule(schedule) {
            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('scheduleContent').style.display = 'block';
            
            // ë‚ ì§œ í‘œì‹œ
            const date = new Date(document.getElementById('scheduleDate').value || new Date());
            const days = ['ì¼ìš”ì¼', 'ì›”ìš”ì¼', 'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼'];
            const dateStr = `${date.getFullYear()}ë…„ ${date.getMonth() + 1}ì›” ${date.getDate()}ì¼ ${days[date.getDay()]}`;
            document.getElementById('scheduleDateDisplay').textContent = dateStr;
            
            // í†µê³„ ê³„ì‚°
            let totalCount = 0;
            let morningCount = 0;
            let afternoonCount = 0;
            
            // ì‹œê°„í‘œ ìƒì„±
            const container = document.getElementById('scheduleTableContainer');
            container.innerHTML = '';
            
            lunchSlots.forEach(slot => {
                if (schedule[slot] && schedule[slot].length > 0) {
                    const slotDiv = document.createElement('div');
                    slotDiv.className = 'time-slot';
                    
                    const content = document.createElement('div');
                    content.className = 'time-slot-content';
                    
                    const timeLabel = document.createElement('div');
                    timeLabel.className = 'time-label';
                    timeLabel.textContent = slot;
                    
                    const personList = document.createElement('div');
                    personList.className = 'person-list';
                    
                    schedule[slot].forEach(emp => {
                        const badge = document.createElement('span');
                        badge.className = 'person-badge';
                        
                        if (leaders.includes(emp.name)) {
                            badge.className += ' leader-badge';
                            badge.textContent = `${emp.name} (${emp.team})`;
                        } else {
                            badge.className += ' ' + getTeamClass(emp.team);
                            badge.textContent = `${emp.name} (${emp.team})`;
                        }
                        
                        personList.appendChild(badge);
                        
                        totalCount++;
                        if (emp.shift === 'ì˜¤ì „') morningCount++;
                        else afternoonCount++;
                    });
                    
                    content.appendChild(timeLabel);
                    content.appendChild(personList);
                    slotDiv.appendChild(content);
                    container.appendChild(slotDiv);
                }
            });
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            document.getElementById('totalCount').textContent = totalCount;
            document.getElementById('morningCount').textContent = morningCount;
            document.getElementById('afternoonCount').textContent = afternoonCount;
            
            // ë‚´ ì ì‹¬ ì‹œê°„ ì—…ë°ì´íŠ¸
            updateMyLunchTime();
        }
        
        // ë©”ì‹œì§€ í‘œì‹œ
        function showSuccess(message) {
            const div = document.getElementById('successMessage');
            div.textContent = message;
            div.style.display = 'block';
            setTimeout(() => {
                div.style.display = 'none';
            }, 3000);
        }
        
        function showWarning(message) {
            const div = document.getElementById('warningMessage');
            div.textContent = message;
            div.style.display = 'block';
            setTimeout(() => {
                div.style.display = 'none';
            }, 3000);
        }
        
        // í˜ì´ì§€ í´ë¦­ ì‹œ ê²€ìƒ‰ ì œì•ˆ ë‹«ê¸°
        document.addEventListener('click', function(event) {
            const searchInput = document.getElementById('specialSearchInput');
            const suggestionsDiv = document.getElementById('searchSuggestions');
            
            if (!searchInput.contains(event.target) && !suggestionsDiv.contains(event.target)) {
                suggestionsDiv.classList.remove('active');
            }
        });
    </script>
</body>
</html>
